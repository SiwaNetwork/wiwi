# Дорожная карта разработки оборудования ретрансляции фазовой синхронизации по Wi-Fi

## Общая информация

- **Продолжительность**: 7 месяцев (сокращено благодаря адаптации)
- **Количество опытных образцов**: 5 штук
- **Команда**: 8 специалистов
- **Бюджет**: 17,120,400 руб

## ✅ Обновленная стратегия разработки

**Адаптация существующих решений**: Согласно детальному анализу протоколов PTP G.8275.1 и WiWi, протокол WiWi имеет хорошую основу для адаптации под стандарт. Возможность адаптации составляет 75%, что сокращает время разработки на 1 месяц.

**Расширенное использование существующих проектов**:
- ✅ Базовая архитектура STM32H7 + FPGA
- ✅ Протокол WiWi с алгоритмами синхронизации
- ✅ PID контроллеры для коррекции генератора
- ✅ ClockMatrix и FPGA timestamping возможности
- ✅ Фазовая синхронизация с I/Q данными
- ✅ Опыт команды в области синхронизации времени

## Детальный план по месяцам

### МЕСЯЦ 1: Архитектурное проектирование

#### Неделя 1-2: Системная архитектура
**Ответственные**: Ведущий инженер, Инженер-разработчик (2 чел.)

**Задачи:**
- [ ] Детальный анализ требований ТЗ (±300 нс точность)
- [ ] Анализ адаптации протокола WiWi под G.8275.1
- [ ] Создание технического задания на адаптацию существующих решений
- [ ] Выбор архитектуры системы (Master/Slave/Boundary Clock модули)
- [ ] Выбор специализированных компонентов:
  - [ ] Wi-Fi 6E модули с поддержкой hardware timestamping
  - [ ] GNSS приемник с высокоточным PPS выходом
  - [ ] OCXO генератор ±0.05 ppm для PTP интерфейсов
  - [ ] STM32H7 микроконтроллер (адаптация существующего кода)
  - [ ] FPGA с поддержкой PTP hardware timestamping (развитие ClockMatrix)
- [ ] Проектирование интерфейсов между модулями
- [ ] Определение требований к антенным системам (2.4/5/6 ГГц MIMO 2x2)

**Результаты:**
- Техническое задание на разработку
- Системная архитектура
- Спецификация компонентов
- Блок-схемы системы

**Критерии готовности:**
- Утвержденная системная архитектура
- Выбранные поставщики компонентов
- Определены интерфейсы и протоколы

#### Неделя 3-4: Проектирование аппаратуры
**Ответственные**: Инженер по радиочастотам, Инженер-разработчик

**Задачи:**
- [ ] Проектирование схемотехники Master модуля
- [ ] Проектирование схемотехники Slave модуля
- [ ] Размещение компонентов на PCB
- [ ] Расчет тепловых режимов и вентиляции
- [ ] Проектирование антенных систем для 2.4/5/6 ГГц
- [ ] Проектирование корпусов и механических деталей
- [ ] Расчет ЭМС совместимости

**Результаты:**
- Принципиальные схемы Master/Slave модулей
- Макеты печатных плат
- 3D модели корпусов
- Спецификация антенн
- Техническое задание на механические детали

**Критерии готовности:**
- Готовы к производству печатные платы
- Утверждены механические чертежи
- Выбраны антенные системы

### МЕСЯЦ 2: Изготовление прототипов

#### Неделя 1-2: Заказ и поставка компонентов
**Ответственные**: Техник-сборщик, Ведущий инженер

**Задачи:**
- [ ] Размещение заказов на компоненты
- [ ] Заказ печатных плат (20 штук)
- [ ] Заказ антенных систем (15 штук)
- [ ] Заказ корпусов и механических деталей
- [ ] Подготовка рабочего места для сборки
- [ ] Подготовка измерительного оборудования

**Результаты:**
- Заказанные компоненты
- Изготовленные печатные платы
- Готовое рабочее место

#### Неделя 3-4: Сборка прототипов
**Ответственные**: Техник-сборщик, Инженер-разработчик

**Задачи:**
- [ ] Сборка 5 опытных образцов Master модулей
- [ ] Сборка 5 опытных образцов Slave модулей
- [ ] Первичное тестирование собранных модулей
- [ ] Измерение базовых параметров
- [ ] Документирование процесса сборки

**Результаты:**
- 5 опытных образцов Master модулей
- 5 опытных образцов Slave модулей
- Отчеты о первичном тестировании
- Документация по сборке

**Критерии готовности:**
- Все образцы собраны и протестированы
- Измерены базовые электрические параметры
- Документирован процесс сборки

### МЕСЯЦ 3: Отладка аппаратуры

#### Неделя 1-2: Отладка схемотехники
**Ответственные**: Инженер-разработчик, Инженер по радиочастотам

**Задачи:**
- [ ] Отладка питания и стабилизации напряжений
- [ ] Тестирование интерфейсов (SPI, I2C, UART)
- [ ] Отладка Wi-Fi модулей
- [ ] Тестирование GNSS приемника
- [ ] Калибровка OCXO генератора
- [ ] Измерение характеристик антенн

**Результаты:**
- Отлаженная схемотехника
- Измеренные характеристики компонентов
- Отчеты о тестировании

#### Неделя 3-4: Системная интеграция аппаратуры
**Ответственные**: Ведущий инженер, все инженеры

**Задачи:**
- [ ] Интеграция всех подсистем
- [ ] Тестирование взаимодействия модулей
- [ ] Измерение ЭМС характеристик
- [ ] Тепловое тестирование
- [ ] Исправление выявленных проблем
- [ ] Подготовка к программной разработке

**Результаты:**
- Полностью отлаженная аппаратура
- Отчеты о системном тестировании
- Готовность к программной разработке

**Критерии готовности:**
- Все модули работают стабильно
- Измерены все ключевые параметры
- Готовы к загрузке программного обеспечения

### МЕСЯЦ 4: Базовое программное обеспечение

#### Неделя 1-2: Адаптация базового ПО WiWi
**Ответственные**: Программист встраиваемых систем (2 чел.)

**Задачи:**
- [ ] Анализ и портирование базовой архитектуры WiWi проектов
- [ ] Адаптация системы инициализации STM32H7 под новые компоненты
- [ ] Адаптация существующих драйверов для специализированных компонентов
- [ ] Интеграция системы управления питанием и тактированием
- [ ] Адаптация базовых тестовых программ
- [ ] Развитие системы диагностики и мониторинга

**Результаты:**
- Адаптированная базовая прошивка на основе WiWi
- Система инициализации с новыми компонентами
- Базовые тестовые программы
- Расширенная система диагностики

#### Неделя 3-4: Драйверы периферии
**Ответственные**: Программист встраиваемых систем, Программист FPGA

**Задачи:**
- [ ] Драйвер Wi-Fi 6E модулей с поддержкой hardware timestamping
- [ ] Драйвер GNSS приемника с высокоточным PPS
- [ ] Драйвер OCXO генератора ±0.05 ppm
- [ ] Драйвер SFP/SFP+ портов с PTP поддержкой
- [ ] Драйверы FPGA для hardware timestamping
- [ ] Система мониторинга и диагностики
- [ ] Драйверы антенных переключателей (2.4/5/6 ГГц)

**Результаты:**
- Полные драйверы всех специализированных компонентов
- Система мониторинга и диагностики
- Базовая прошивка для новой платформы

**Критерии готовности:**
- Все компоненты управляются программно
- Работает базовая диагностика
- Готовы к реализации PTP

### МЕСЯЦ 5: Адаптация протокола WiWi под PTP G.8275.1

#### Неделя 1-2: Базовая совместимость PTP
**Ответственные**: Программист встраиваемых систем, Ведущий инженер

**Задачи:**
- [ ] Изучение стандарта IEEE 1588-2008 и профиля G.8275.1
- [ ] Анализ существующего протокола WiWi (Delay_Req/Delay_Resp)
- [ ] Адаптация WiWi под стандартные PTP сообщения
- [ ] Добавление Sync/Follow_Up сообщений в протокол WiWi
- [ ] Реализация алгоритма Best Master Clock (BMC)
- [ ] Адаптация существующей State Machine под PTP
- [ ] Интеграция фазовых I/Q данных с PTP временными метками

**Результаты:**
- Адаптированный протокол WiWi с PTP совместимостью
- Работающие PTP сообщения на основе WiWi
- Алгоритм выбора Master с BMC

#### Неделя 3-4: Hardware timestamping и синхронизация
**Ответственные**: Программист FPGA, Программист встраиваемых систем

**Задачи:**
- [ ] Развитие существующих FPGA timestamping возможностей
- [ ] Адаптация ClockMatrix для PTP hardware timestamping
- [ ] Интеграция существующих PID контроллеров с PTP
- [ ] Адаптация фазовых алгоритмов WiWi для достижения ±300 нс
- [ ] Компенсация задержек в Wi-Fi сети
- [ ] Алгоритм Holdover при потере сигнала
- [ ] Автономная компенсация задержек (autonomous delay compensation)
- [ ] Тестирование точности синхронизации

**Результаты:**
- Развитый hardware timestamping на основе ClockMatrix
- Адаптированные алгоритмы синхронизации WiWi для ±300 нс
- Достигнута требуемая точность синхронизации

**Критерии готовности:**
- PTP работает по стандарту G.8275.1
- Hardware timestamping функционирует
- Достигнута требуемая точность

### МЕСЯЦ 6: Wi-Fi интеграция и замена LoRa

#### Неделя 1-2: Замена LoRa на Wi-Fi 6E
**Ответственные**: Инженер по радиочастотам, Программист встраиваемых систем

**Задачи:**
- [ ] Адаптация протокола WiWi с LoRa на Wi-Fi 6E транспорт
- [ ] Настройка Wi-Fi 6E модулей для работы в 2.4/5/6 ГГц
- [ ] Реализация MIMO 2x2 для каждого диапазона
- [ ] Алгоритм быстрого переключения между диапазонами (< 200 мс)
- [ ] Обработка нестабильности модуляции Wi-Fi
- [ ] Интеграция Wi-Fi с адаптированным протоколом WiWi
- [ ] Сохранение фазовых I/Q данных при переходе на Wi-Fi
- [ ] Тестирование дальности связи с сохранением точности

**Результаты:**
- Протокол WiWi работает через Wi-Fi 6E вместо LoRa
- Работающий Wi-Fi 6E с PTP поддержкой
- Алгоритм переключения диапазонов
- Измеренные характеристики связи

#### Неделя 3-4: Сетевая интеграция и управление
**Ответственные**: Программист встраиваемых систем, Ведущий инженер

**Задачи:**
- [ ] Интеграция Wi-Fi 6E с PTP G.8275.1
- [ ] Реализация сетевых интерфейсов (Ethernet, Wi-Fi)
- [ ] Web-интерфейс управления
- [ ] SNMP интерфейс для телекоммуникационного оборудования
- [ ] Система мониторинга и аварийной сигнализации
- [ ] Мониторинг фазовых отклонений PTP (Minor/Major/Critical)
- [ ] Система обновления прошивки

**Результаты:**
- Полная сетевая интеграция Wi-Fi + PTP
- Система управления телекоммуникационным оборудованием
- Мониторинг и диагностика синхронизации

**Критерии готовности:**
- Wi-Fi работает во всех диапазонах
- Реализована система управления
- Готово к системному тестированию

### МЕСЯЦ 7: Расширенная функциональность PTP

#### Неделя 1-2: Boundary Clock и Transparent Clock
**Ответственные**: Программист встраиваемых систем, Программист FPGA

**Задачи:**
- [ ] Реализация Boundary Clock функциональности
- [ ] Добавление Transparent Clock для коммутаторов
- [ ] Адаптация существующей архитектуры WiWi под промежуточные узлы
- [ ] Реализация security и аутентификации PTP сообщений
- [ ] Оптимизация алгоритмов под точность ±300 нс
- [ ] Интеграция с существующими PID контроллерами
- [ ] Тестирование в сложных сетевых топологиях

**Результаты:**
- Полная совместимость с G.8275.1
- Поддержка сложных сетевых топологий
- Достижение требуемой точности ±300 нс

#### Неделя 3-4: Системная интеграция
**Ответственные**: Ведущий инженер, все разработчики

**Задачи:**
- [ ] Интеграция всех подсистем (Wi-Fi + PTP + ClockMatrix)
- [ ] Тестирование взаимодействия компонентов
- [ ] Оптимизация производительности системы
- [ ] Отладка и устранение проблем
- [ ] Подготовка к системному тестированию

**Результаты:**
- Полностью интегрированная система
- Все подсистемы работают совместно
- Готовность к системному тестированию

### МЕСЯЦ 8: Финальное тестирование и оптимизация (сокращено)

#### Неделя 1-2: Интеграция подсистем
**Ответственные**: Ведущий инженер, все разработчики

**Задачи:**
- [ ] Интеграция всех подсистем в единую систему
- [ ] Тестирование взаимодействия Master/Slave
- [ ] Оптимизация производительности
- [ ] Отладка взаимодействий между модулями
- [ ] Тестирование в различных конфигурациях
- [ ] Измерение системных характеристик

**Результаты:**
- Интегрированная система
- Отчеты о системном тестировании
- Оптимизированное ПО

#### Неделя 3-4: Лабораторное тестирование
**Ответственные**: Тестировщик, все разработчики

**Задачи:**
- [ ] Комплексное тестирование системы
- [ ] Измерение точности синхронизации
- [ ] Тестирование стабильности
- [ ] Стресс-тестирование
- [ ] Тестирование отказоустойчивости
- [ ] Подготовка к полевым испытаниям

**Результаты:**
- Полные отчеты о тестировании
- Готовность к полевым испытаниям
- Документация по эксплуатации

**Критерии готовности:**
- Система работает стабильно
- Достигнуты все требования ТЗ
- Готово к полевым испытаниям

### МЕСЯЦ 8: Финальное тестирование

#### Неделя 1-2: Полевые испытания
**Ответственные**: Тестировщик, Ведущий инженер, представители заказчика

**Задачи:**
- [ ] Установка системы в полевых условиях
- [ ] 24-часовое непрерывное тестирование (требование ТЗ)
- [ ] Тестирование в условиях помех и многолучевости
- [ ] Тестирование дальности Wi-Fi связи с сохранением точности
- [ ] Измерение точности синхронизации ±300 нс в реальных условиях
- [ ] Интеграция с оборудованием заказчика
- [ ] Тестирование в различных конфигурациях транспортной сети

**Результаты:**
- Отчеты о полевых испытаниях
- Измеренные характеристики в реальных условиях
- Подтверждение соответствия всем требованиям ТЗ

#### Неделя 3-4: Документирование и сдача
**Ответственные**: Ведущий инженер, все разработчики

**Задачи:**
- [ ] Финальная документация
- [ ] Руководства пользователя
- [ ] Техническая документация
- [ ] Подготовка к серийному производству
- [ ] Обучение персонала заказчика
- [ ] Передача результатов

**Результаты:**
- Полная техническая документация
- Готовность к серийному производству
- Обученный персонал заказчика

**Критерии готовности:**
- Все требования ТЗ выполнены
- Система готова к эксплуатации
- Полная документация передана

## Ключевые вехи проекта

| Месяц | Ключевая веха | Критерии успеха |
|-------|---------------|-----------------|
| 1 | Архитектура утверждена | Готовы чертежи и спецификации |
| 2 | Прототипы собраны | 5 рабочих образцов |
| 3 | Аппаратура отлажена | Все модули работают стабильно |
| 4 | Базовое ПО готово | Все компоненты управляются |
| 5 | WiWi адаптирован под PTP | Базовая совместимость с G.8275.1 |
| 6 | LoRa заменен на Wi-Fi 6E | Протокол WiWi работает через Wi-Fi |
| 7 | Расширенная функциональность | Boundary Clock, полная совместимость |
| 8 | Проект завершен | Соответствие всем требованиям ТЗ |

## Управление рисками

### Критические риски по месяцам

**Месяц 1-2**: Задержка поставки специализированных компонентов
- **Риск**: Wi-Fi 6E модули, OCXO генераторы, GNSS приемники
- **Митигация**: Параллельные поставщики, резервные варианты, ранние заказы

**Месяц 3-4**: Сложность отладки новой аппаратуры
- **Риск**: Hardware timestamping, высокоточные генераторы
- **Митигация**: Раннее тестирование, консультации с поставщиками

**Месяц 5**: Адаптация протокола WiWi под PTP G.8275.1
- **Риск**: Сложность адаптации существующих алгоритмов под стандарт
- **Митигация**: Использование существующих PID контроллеров WiWi, консультации экспертов

**Месяц 6**: Замена LoRa на Wi-Fi 6E в протоколе WiWi
- **Риск**: Адаптация протокола WiWi с LoRa на Wi-Fi транспорт
- **Митигация**: Использование существующей архитектуры WiWi, раннее тестирование Wi-Fi модулей

**Месяц 7-8**: Интеграционные проблемы и соответствие ТЗ
- **Риск**: Комплексная интеграция всех подсистем
- **Митигация**: Поэтапная интеграция, раннее тестирование

## Ресурсы и команда

### Состав команды
- **Ведущий инженер**: Общее руководство, архитектура
- **Инженер-разработчик (2)**: Аппаратное проектирование
- **Инженер по радиочастотам**: Wi-Fi, антенны, ЭМС
- **Программист FPGA**: Цифровая обработка сигналов
- **Программист встраиваемых систем (2)**: ПО микроконтроллера
- **Тестировщик**: Тестирование и валидация
- **Техник-сборщик**: Сборка прототипов

### Необходимое оборудование
- Рабочие места для разработки
- Измерительное оборудование (осциллографы, анализаторы спектра)
- Стенды для тестирования
- 3D принтер для прототипов корпусов
- Паяльные станции
- Компьютеры для разработки

---

*Дорожная карта составлена с учетом требований ТЗ и опыта существующих проектов WiWi.*
